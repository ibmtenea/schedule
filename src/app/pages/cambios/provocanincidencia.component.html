
<div class="container-fluid">
    <div class="row">
    <div class="col-12 p-0 mt-5">
        <h2>Cambios que provocan incidencia– 72h previas</h2>
    </div>
    </div>

  
    <div class="row">
      <div class="col-9 text-left p-0 mt-2">
 
        <a      
        title="Ayuda"
        (click)="open(camicon)"
        class="btn btn-info pointerplus btn-circle"
        ><i class="fa fa-plus fa-2"></i
          > </a>

      </div>
      <div class="col-3 p-0 mt-2 text-right">
        <div class="form">
          <mat-form-field floatPlaceholder="never" color="accent">
            <input matInput placeholder="Buscar" (keyup)="updateFilter($event)" />
          </mat-form-field>
        </div>
      </div>
    </div>
  




    <div class="row">
      <div class="col-12 p-0 m-0">
        <ngx-datatable
          #mydatatable
          class="material striped"
          headerHeight="50"
          [limit]="25"
          [columnMode]="'force'"
          footerHeight="50"
          rowHeight="50"
          [rows]="rows"
          [messages]="my_messages"
        >
          <ngx-datatable-column name="id_cami" [maxWidth]="60">
            <ng-template ngx-datatable-header-template>
              <span>ID</span>
            </ng-template>
            <ng-template
              class="mat-column-id"
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row"
              ><div class="text-center">{{ row.id_cami }}</div>
            </ng-template>
          </ngx-datatable-column>
  

          <!-- <ngx-datatable-column name="defcon_fecha" [maxWidth]="100">
            <ng-template ngx-datatable-header-template>
              <span>Fecha</span>
            </ng-template>
            <ng-template
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row">
            <span title="Doble click para editar"
            (dblclick)="editing[rowIndex + '-defcon_fecha'] = true"
            *ngIf="!editing[rowIndex + '-defcon_fecha']"
            >
            {{ row.defcon_fecha }}
            <span class="text-muted2" *ngIf="row.defcon_fecha === null"> vacío &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          </span>
          <input autofocus
            (clickOutside)="editing[rowIndex + '-defcon_fecha'] = false"
            (keyup.enter)="updateValue($event, 'defcon_fecha', rowIndex)"
            *ngIf="editing[rowIndex + '-defcon_fecha']"
            type="text"
            class="form-control"
            [value]="row.defcon_fecha"
            [title]="row.id_cami"
          /></ng-template>
          </ngx-datatable-column> -->
          <ngx-datatable-column name="cami_id" [maxWidth]="130">
            <ng-template ngx-datatable-header-template>
              <span>Identificador</span>
            </ng-template>
            <ng-template
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row">
            <span title="Doble click para editar"
            (dblclick)="editing[rowIndex + '-cami_id'] = true"
            *ngIf="!editing[rowIndex + '-cami_id']"
            >
            {{ row.cami_id }}
            <span class="text-muted2" *ngIf="row.cami_id === null"> vacío &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          </span>
          <input autofocus
            (clickOutside)="editing[rowIndex + '-cami_id'] = false"
            (keyup.enter)="updateValue($event, 'cami_id', rowIndex)"
            *ngIf="editing[rowIndex + '-cami_id']"
            type="text"
            class="form-control"
            [value]="row.cami_id"
            [title]="row.id_cami"
          /></ng-template>
          </ngx-datatable-column>


          <ngx-datatable-column name="cami_titulo" [maxWidth]="390">
            <ng-template ngx-datatable-header-template>
              <span>Título</span>
            </ng-template>
            <ng-template
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row">
            <span title="Doble click para editar"
            (dblclick)="editing[rowIndex + '-cami_titulo'] = true"
            *ngIf="!editing[rowIndex + '-cami_titulo']"
            >
            {{ row.cami_titulo }}
            <span class="text-muted2" *ngIf="row.cami_titulo === null"> vacío &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          </span>
          <input autofocus
            (clickOutside)="editing[rowIndex + '-cami_titulo'] = false"
            (keyup.enter)="updateValue($event, 'cami_titulo', rowIndex)"
            *ngIf="editing[rowIndex + '-cami_titulo']"
            type="text"
            class="form-control"
            [value]="row.cami_titulo"
            [title]="row.id_cami"
          /></ng-template>
          </ngx-datatable-column>
          
          <ngx-datatable-column name="cami_comentarios" [maxWidth]="600">
            <ng-template ngx-datatable-header-template>
              <span>Comentarios</span>
            </ng-template>
            <ng-template
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row">
            <span title="Doble click para editar"
            (dblclick)="editing[rowIndex + '-cami_comentarios'] = true"
            *ngIf="!editing[rowIndex + '-cami_comentarios']"
            >
            {{ row.cami_comentarios }}
            <span class="text-muted2" *ngIf="row.cami_comentarios === null"> vacío &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          </span>
          <input autofocus
            (clickOutside)="editing[rowIndex + '-cami_comentarios'] = false"
            (keyup.enter)="updateValue($event, 'cami_comentarios', rowIndex)"
            *ngIf="editing[rowIndex + '-cami_comentarios']"
            type="text"
            class="form-control"
            [value]="row.cami_comentarios"
            [title]="row.id_cami"
          /></ng-template>
          </ngx-datatable-column>
        
          <ngx-datatable-column name="cami_grupo" [maxWidth]="220">
            <ng-template ngx-datatable-header-template>
              <span>Grupo</span>
            </ng-template>
            <ng-template
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row">
            <span title="Doble click para editar"
            (dblclick)="editing[rowIndex + '-cami_grupo'] = true"
            *ngIf="!editing[rowIndex + '-cami_grupo']"
            >
            {{ row.cami_grupo }}
            <span class="text-muted2" *ngIf="row.cami_grupo === null"> vacío &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          </span>
          <input autofocus
            (clickOutside)="editing[rowIndex + '-cami_grupo'] = false"
            (keyup.enter)="updateValue($event, 'cami_grupo', rowIndex)"
            *ngIf="editing[rowIndex + '-cami_grupo']"
            type="text"
            class="form-control"
            [value]="row.cami_grupo"
            [title]="row.id_cami"
          /></ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="cami_responsable" [maxWidth]="220">
            <ng-template ngx-datatable-header-template>
              <span>Responsable</span>
            </ng-template>
            <ng-template
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row">
            <span title="Doble click para editar"
            (dblclick)="editing[rowIndex + '-cami_responsable'] = true"
            *ngIf="!editing[rowIndex + '-cami_responsable']"
            >
            {{ row.cami_responsable }}
            <span class="text-muted2" *ngIf="row.cami_responsable === null"> vacío &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          </span>
          <input autofocus
            (clickOutside)="editing[rowIndex + '-cami_responsable'] = false"
            (keyup.enter)="updateValue($event, 'cami_responsable', rowIndex)"
            *ngIf="editing[rowIndex + '-cami_responsable']"
            type="text"
            class="form-control"
            [value]="row.cami_responsable"
            [title]="row.id_cami"
          /></ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="cami_cio" [maxWidth]="220">
            <ng-template ngx-datatable-header-template>
              <span>CIO</span>
            </ng-template>
            <ng-template
              ngx-datatable-cell-template
              let-rowIndex="rowIndex"
              let-value="value"
              let-row="row">
            <span title="Doble click para editar"
            (dblclick)="editing[rowIndex + '-cami_cio'] = true"
            *ngIf="!editing[rowIndex + '-cami_cio']"
            >
            {{ row.cami_cio }}
            <span class="text-muted2" *ngIf="row.cami_cio === null"> vacío &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          </span>
          <input autofocus
            (clickOutside)="editing[rowIndex + '-cami_cio'] = false"
            (keyup.enter)="updateValue($event, 'cami_cio', rowIndex)"
            *ngIf="editing[rowIndex + '-cami_cio']"
            type="text"
            class="form-control"
            [value]="row.cami_cio"
            [title]="row.id_cami"
          /></ng-template>
          </ngx-datatable-column>

         



          
  
         
  
          <!-- <ngx-datatable-column name="ver" [maxWidth]="150">
        <ng-template
          class="mat-column-id"
          ngx-datatable-cell-template
          let-row="row"
        >
  
          <div class="text-center">
            <div class="row">
              <div class="col-12 p0 m0">
  
  
  <div *ngIf="row.disabledBotones===turnoValor && registroroleperson.id_rol!= '8'">
                <button (click)="duplicar(row, i)"
                class="btn btn-warning botonsizes mr-1">
                    <i class="fa fa-clone"></i>
                </button>
                <a
                  [routerLink]="['/detalle', row.tokenid]"
                  class="btn btn-warning botonsizes mr-1"
                  ><i class="fa fa-pencil"></i
                ></a>
                <button
                  (click)="borrarRegistro(row, i)"
                  class="btn btn-warning botonsizes"
                >
                  <i class="fa fa-trash"></i>
                </button>
  </div> 
  
  <div *ngIf="registroroleperson.id_rol== '8'">
              <button (click)="duplicar(row, i)"
              class="btn btn-warning botonsizes mr-1">
                  <i class="fa fa-clone"></i>
              </button>
              <a
                [routerLink]="['/detalle', row.tokenid]"
                class="btn btn-warning botonsizes mr-1"
                ><i class="fa fa-pencil"></i
              ></a>
              <button
                (click)="borrarRegistro(row, i)"
                class="btn btn-warning botonsizes"
              >
                <i class="fa fa-trash"></i>
              </button>
  </div> 
  
  
              </div>
            </div>
          </div>
        </ng-template>
      </ngx-datatable-column> -->
        </ngx-datatable>
      </div>
    </div>
  </div>
  <ng-template #camicon let-modal class="modal-lg">
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Incidencias</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">×</span>
      </button>
    </div>
    <div class="modal-body">
  
    <form [formGroup]="CamiForm" (ngSubmit)="submitdef()" class="formulario" novalidate>
          <input type="hidden" class="form-control"  name="id_persona"  formControlName="id_persona"  />

          <div class="row">
            <div class="col-md-4 mb-2 fechainput">
              <div class="form-group"><label for="cami_id">Identificador</label>
                <div class="input-group">
                  <input type="text" 
                  class="form-control"  
                  name="cami_id" 
                  formControlName="cami_id">
                </div>
              </div>
            </div>
            <div class="col-md-4 mb-2 fechainput">
              <div class="form-group"><label for="cami_titulo">Título</label>
                <div class="input-group">
                  <input type="text" 
                  class="form-control"  
                  name="cami_titulo" 
                  formControlName="cami_titulo">
                </div>
              </div>
            </div>
            <div class="col-md-4 mb-2 fechainput">
              <div class="form-group"><label for="cami_grupo">Grupo</label>
                <div class="input-group">
                  <input type="text" 
                  class="form-control"  
                  name="cami_grupo" 
                  formControlName="cami_grupo">
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-4 mb-2 fechainput">
              <div class="form-group"><label for="cami_responsable">Responsable</label>
                <div class="input-group">
                  <input type="text" 
                  class="form-control"  
                  name="cami_responsable" 
                  formControlName="cami_responsable">
                </div>
              </div>
            </div>
            <div class="col-md-4 mb-2 fechainput">

              <div class="form-group"><label for="cami_cio">CIO</label>
                <div class="input-group">
                  <input type="text" 
                  class="form-control"  
                  name="cami_cio" 
                  formControlName="cami_cio">
                </div>
              </div>
    

            </div>
            <div class="col-md-4 mb-2 fechainput">
              
            </div>
          </div>

          <div class="row">
            <div class="col-md-12 mb-2 fechainput">
              <div class="form-group"><label for="cami_comentarios">Comentarios</label>
                <div class="input-group">
                  <input type="text" 
                  class="form-control"  
                  name="cami_comentarios" 
                  formControlName="cami_comentarios">
                </div>
              </div>              

        </div>
      </div> 


          <p class="text-center"><button type="submit" [disabled]="CamiForm.invalid" class="btn btn-primary">Guardar</button></p>  
    </form>
  
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Cerrar</button>
    </div>
  </ng-template>